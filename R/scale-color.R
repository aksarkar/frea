requireNamespace('ggplot2')

color_by_eid <- c(
  "E001" = "#924965",
  "E002" = "#924965",
  "E003" = "#924965",
  "E004" = "#4178AE",
  "E005" = "#4178AE",
  "E006" = "#4178AE",
  "E007" = "#4178AE",
  "E008" = "#924965",
  "E009" = "#4178AE",
  "E010" = "#4178AE",
  "E011" = "#4178AE",
  "E012" = "#4178AE",
  "E013" = "#4178AE",
  "E014" = "#924965",
  "E015" = "#924965",
  "E016" = "#924965",
  "E017" = "#E41A1C",
  "E018" = "#69608A",
  "E019" = "#69608A",
  "E020" = "#69608A",
  "E021" = "#69608A",
  "E022" = "#69608A",
  "E023" = "#B65C73",
  "E024" = "#924965",
  "E025" = "#B65C73",
  "E026" = "#B65C73",
  "E027" = "#FF9D0C",
  "E028" = "#FF9D0C",
  "E029" = "#678C69",
  "E030" = "#678C69",
  "E031" = "#678C69",
  "E032" = "#678C69",
  "E033" = "#55A354",
  "E034" = "#55A354",
  "E035" = "#678C69",
  "E036" = "#678C69",
  "E037" = "#55A354",
  "E038" = "#55A354",
  "E039" = "#55A354",
  "E040" = "#55A354",
  "E041" = "#55A354",
  "E042" = "#55A354",
  "E043" = "#55A354",
  "E044" = "#55A354",
  "E045" = "#55A354",
  "E046" = "#678C69",
  "E047" = "#55A354",
  "E048" = "#55A354",
  "E049" = "#B65C73",
  "E050" = "#678C69",
  "E051" = "#678C69",
  "E052" = "#E67326",
  "E053" = "#FFD924",
  "E054" = "#FFD924",
  "E055" = "#FF9D0C",
  "E056" = "#FF9D0C",
  "E057" = "#FF9D0C",
  "E058" = "#FF9D0C",
  "E059" = "#FF9D0C",
  ## "E060" = "#FF0000", thrown out
  "E061" = "#FF9D0C",
  "E062" = "#55A354",
  "E063" = "#AF5B39",
  ## "E064" = "#FF0000", thrown out
  "E065" = "#D56F80",
  "E066" = "#999999",
  "E067" = "#C5912B",
  "E068" = "#C5912B",
  "E069" = "#C5912B",
  "E070" = "#C5912B",
  "E071" = "#C5912B",
  "E072" = "#C5912B",
  "E073" = "#C5912B",
  "E074" = "#C5912B",
  "E075" = "#C58DAA",
  "E076" = "#F182BC",
  "E077" = "#C58DAA",
  "E078" = "#F182BC",
  "E079" = "#C58DAA",
  "E080" = "#999999",
  "E081" = "#C5912B",
  "E082" = "#C5912B",
  "E083" = "#D56F80",
  "E084" = "#C58DAA",
  "E085" = "#C58DAA",
  "E086" = "#999999",
  "E087" = "#999999",
  "E088" = "#999999",
  "E089" = "#C2655D",
  "E090" = "#C2655D",
  "E091" = "#999999",
  "E092" = "#C58DAA",
  "E093" = "#DAB92E",
  "E094" = "#C58DAA",
  "E095" = "#D56F80",
  "E096" = "#999999",
  "E097" = "#999999",
  "E098" = "#999999",
  "E099" = "#999999",
  "E100" = "#C2655D",
  "E101" = "#C58DAA",
  "E102" = "#C58DAA",
  "E103" = "#F182BC",
  "E104" = "#D56F80",
  "E105" = "#D56F80",
  "E106" = "#C58DAA",
  "E107" = "#C2655D",
  "E108" = "#C2655D",
  "E109" = "#C58DAA",
  "E110" = "#C58DAA",
  "E111" = "#F182BC",
  "E112" = "#DAB92E",
  "E113" = "#999999",
  "E114" = "#000000",
  "E115" = "#000000",
  "E116" = "#000000",
  "E117" = "#000000",
  "E118" = "#000000",
  "E119" = "#000000",
  "E120" = "#000000",
  "E121" = "#000000",
  "E122" = "#000000",
  "E123" = "#000000",
  "E124" = "#000000",
  "E125" = "#000000",
  "E126" = "#000000",
  "E127" = "#000000")

color_by_names <- c(
  'ES-I3_Cell_Line' = '#924965',
  'ES-WA7_Cell_Line' = '#924965',
  'H1_Cell_Line' = '#924965',
  'H1_BMP4_Derived_Mesendoderm_Cultured_Cells' = '#4178AE',
  'H1_BMP4_Derived_Trophoblast_Cultured_Cells' = '#4178AE',
  'H1_Derived_Mesenchymal_Stem_Cells' = '#4178AE',
  'H1_Derived_Neuronal_Progenitor_Cultured_Cells' = '#4178AE',
  'H9_Cell_Line' = '#924965',
  'H9_Derived_Neuronal_Progenitor_Cultured_Cells' = '#4178AE',
  'H9_Derived_Neuron_Cultured_Cells' = '#4178AE',
  'hESC_Derived_CD184+_Endoderm_Cultured_Cells' = '#4178AE',
  'hESC_Derived_CD56+_Ectoderm_Cultured_Cells' = '#4178AE',
  'hESC_Derived_CD56+_Mesoderm_Cultured_Cells' = '#4178AE',
  'HUES48_Cell_Line' = '#924965',
  'HUES6_Cell_Line' = '#924965',
  'HUES64_Cell_Line' = '#924965',
  'IMR90_Cell_Line' = '#E41A1C',
  'iPS-15b_Cell_Line' = '#69608A',
  'iPS-18_Cell_Line' = '#69608A',
  'iPS-20b_Cell_Line' = '#69608A',
  'iPS_DF_6.9_Cell_Line' = '#69608A',
  'iPS_DF_19.11_Cell_Line' = '#69608A',
  'Mesenchymal_Stem_Cell_Derived_Adipocyte_Cultured_Cells' = '#B65C73',
  '4star' = '#924965',
  'Adipose_Derived_Mesenchymal_Stem_Cell_Cultured_Cells' = '#B65C73',
  'Bone_Marrow_Derived_Mesenchymal_Stem_Cell_Cultured_Cells' = '#B65C73',
  'Breast_Myoepithelial_Cells' = '#FF9D0C',
  'Breast_vHMEC' = '#FF9D0C',
  'CD14_Primary_Cells' = '#678C69',
  'CD15_Primary_Cells' = '#678C69',
  'CD19_Primary_Cells_Cord_BI' = '#678C69',
  'CD19_Primary_Cells_Peripheral_UW' = '#678C69',
  'CD3_Primary_Cells_Cord_BI' = '#55A354',
  'CD3_Primary_Cells_Peripheral_UW' = '#55A354',
  'CD34_Primary_Cells' = '#678C69',
  'CD34_Cultured_Cells' = '#678C69',
  'CD4_Memory_Primary_Cells' = '#55A354',
  'CD4_Naive_Primary_Cells' = '#55A354',
  'CD4+_CD25-_CD45RA+_Naive_Primary_Cells' = '#55A354',
  'CD4+_CD25-_CD45RO+_Memory_Primary_Cells' = '#55A354',
  'CD4+_CD25-_IL17-_PMA-Ionomycin_stimulated_MACS_purified_Th_Primary_Cells' = '#55A354',
  'CD4+_CD25-_IL17+_PMA-Ionomcyin_stimulated_Th17_Primary_Cells' = '#55A354',
  'CD4+_CD25-_Th_Primary_Cells' = '#55A354',
  'CD4+_CD25+_CD127-_Treg_Primary_Cells' = '#55A354',
  'CD4+_CD25int_CD127+_Tmem_Primary_Cells' = '#55A354',
  'CD56_Primary_Cells' = '#678C69',
  'CD8_Naive_Primary_Cells' = '#55A354',
  'CD8_Memory_Primary_Cells' = '#55A354',
  'Chondrocytes_from_Bone_Marrow_Derived_Mesenchymal_Stem_Cell_Cultured_Cells' = '#B65C73',
  'Mobilized_CD34_Primary_Cells_Female' = '#678C69',
  'Mobilized_CD34_Primary_Cells_Male' = '#678C69',
  'Muscle_Satellite_Cultured_Cells' = '#E67326',
  'Neurosphere_Cultured_Cells_Cortex_Derived' = '#FFD924',
  'Neurosphere_Cultured_Cells_Ganglionic_Eminence_Derived' = '#FFD924',
  'Penis_Foreskin_Fibroblast_Primary_Cells_skin01' = '#FF9D0C',
  'Penis_Foreskin_Fibroblast_Primary_Cells_skin02' = '#FF9D0C',
  'Penis_Foreskin_Keratinocyte_Primary_Cells_skin02' = '#FF9D0C',
  'Penis_Foreskin_Keratinocyte_Primary_Cells_skin03' = '#FF9D0C',
  'Penis_Foreskin_Melanocyte_Primary_Cells_skin01' = '#FF9D0C',
  'Penis_Foreskin_Melanocyte_Primary_Cells_skin03' = '#FF9D0C',
  'Peripheral_Blood_Mononuclear_Primary_Cells' = '#55A354',
  'Adipose_Nuclei' = '#AF5B39',
  'Aorta' = '#D56F80',
  'Adult_Liver' = '#999999',
  'Brain_Angular_Gyrus' = '#C5912B',
  'Brain_Anterior_Caudate' = '#C5912B',
  'Brain_Cingulate_Gyrus' = '#C5912B',
  'Brain_Germinal_Matrix' = '#C5912B',
  'Brain_Hippocampus_Middle' = '#C5912B',
  'Brain_Inferior_Temporal_Lobe' = '#C5912B',
  'Brain_Mid_Frontal_Lobe' = '#C5912B',
  'Brain_Substantia_Nigra' = '#C5912B',
  'Colonic_Mucosa' = '#C58DAA',
  'Colon_Smooth_Muscle' = '#C58DAA',
  'Duodenum_Mucosa' = '#C58DAA',
  'Duodenum_Smooth_Muscle' = '#C58DAA',
  'Esophagus' = '#C58DAA',
  'Fetal_Adrenal_Gland' = '#999999',
  'Fetal_Brain_Male' = '#C5912B',
  'Fetal_Brain_Female' = '#C5912B',
  'Fetal_Heart' = '#D56F80',
  'Fetal_Intestine_Large' = '#C58DAA',
  'Fetal_Intestine_Small' = '#C58DAA',
  'Fetal_Kidney' = '#999999',
  'Pancreatic_Islets' = '#999999',
  'Fetal_Lung' = '#999999',
  'Fetal_Muscle_Trunk' = '#C2655D',
  'Fetal_Muscle_Leg' = '#C2655D',
  'Fetal_Placenta' = '#999999',
  'Fetal_Stomach' = '#C58DAA',
  'Fetal_Thymus' = '#EFE131',
  'Gastric' = '#C58DAA',
  'Left_Ventricle' = '#D56F80',
  'Lung' = '#999999',
  'Ovary' = '#999999',
  'Pancreas' = '#999999',
  'Placenta_Amnion' = '#999999',
  'Psoas_Muscle' = '#C2655D',
  'Rectal_Mucosa.Donor_29' = '#C58DAA',
  'Rectal_Mucosa.Donor_31' = '#C58DAA',
  'Rectal_Smooth_Muscle' = '#C58DAA',
  'Right_Atrium' = '#D56F80',
  'Right_Ventricle' = '#D56F80',
  'Sigmoid_Colon' = '#C58DAA',
  'Skeletal_Muscle_Male' = '#C2655D',
  'Skeletal_Muscle_Female' = '#C2655D',
  'Small_Intestine' = '#C58DAA',
  'Stomach_Mucosa' = '#C58DAA',
  'Stomach_Smooth_Muscle' = '#C58DAA',
  'Thymus' = '#EFE131',
  'Spleen' = '#999999',
  'A549_EtOH_0.02pct_Lung_Carcinoma' = 'black',
  'Dnd41_TCell_Leukemia' = 'black',
  'GM12878_Lymphoblastoid' = 'black',
  'HeLa-S3_Cervical_Carcinoma' = 'black',
  'HepG2_Hepatocellular_Carcinoma' = 'black',
  'HMEC_Mammary_Epithelial' = 'black',
  'HSMM_Skeletal_Muscle_Myoblasts' = 'black',
  'HSMMtube_Skeletal_Muscle_Myotubes_Derived_from_HSMM' = 'black',
  'HUVEC_Umbilical_Vein_Endothelial_Cells' = 'black',
  'K562_Leukemia' = 'black',
  'Monocytes-CD14+_RO01746' = 'black',
  'NH-A_Astrocytes' = 'black',
  'NHDF-Ad_Adult_Dermal_Fibroblasts' = 'black',
  'NHEK-Epidermal_Keratinocytes' = 'black',
  'NHLF_Lung_Fibroblasts' = 'black',
  'Osteoblasts' = 'black')

color_by_reg2map_v1 <- c(
  '226' = '#924965',
  '225' = '#C58DAA',
  '222' = '#69608A',
  '220' = '#B65C73',
  '219' = '#69608A',
  '218' = '#D56F80',
  '217' = '#999999',
  '216' = '#678C69',
  '215' = '#678C69',
  '213' = '#678C69',
  '212' = '#D56F80',
  '211' = '#924965',
  '210' = '#678C69',
  '209' = '#B65C73',
  '208' = '#FF9D0C',
  '207' = '#55A354',
  '206' = '#B65C73',
  '205' = '#924965',
  '204' = '#F182BC',
  '203' = '#69608A',
  '202' = '#924965',
  '201' = '#FF9D0C',
  '200' = '#924965',
  '199' = '#4178AE',
  '198' = '#678C69',
  '197' = '#55A354',
  '196' = '#FF9D0C',
  '195' = '#999999',
  '194' = '#C58DAA',
  '193' = '#678C69',
  '192' = '#FF9D0C',
  '190' = '#B65C73',
  '189' = '#678C69',
  '188' = '#999999',
  '187' = '#999999',
  '186' = '#55A354',
  '185' = '#999999',
  '184' = '#B65C73',
  '183' = '#D56F80',
  '182' = '#C5912B',
  '181' = '#B65C73',
  '179' = '#D56F80',
  '178' = '#678C69',
  '176' = '#999999',
  '175' = '#4178AE',
  '174' = '#D56F80',
  '173' = '#55A354',
  '172' = '#FF9D0C',
  '171' = '#924965',
  '170' = '#C2655D',
  '169' = '#B65C73',
  '168' = '#924965',
  '167' = '#C2655D',
  '166' = '#C5912B',
  '165' = '#924965',
  '163' = '#FF9D0C',
  '161' = '#C2655D',
  '160' = '#4178AE',
  '159' = '#FF9D0C',
  '158' = '#DAB92E',
  '157' = '#C58DAA',
  '156' = '#4178AE',
  '155' = '#C58DAA',
  '154' = '#E67326',
  '153' = '#678C69',
  '152' = '#55A354',
  '151' = '#C2655D',
  '150' = '#C58DAA',
  '148' = '#C58DAA',
  '147' = '#924965',
  '145' = '#D56F80',
  '144' = '#D56F80',
  '143' = '#C58DAA',
  '142' = '#C58DAA',
  '141' = '#F182BC',
  '140' = '#FF9D0C',
  '139' = '#999999',
  '138' = '#4178AE',
  '137' = '#C58DAA',
  '136' = '#C58DAA',
  '135' = '#55A354',
  '133' = '#F182BC',
  '132' = '#C58DAA',
  '131' = '#924965',
  '130' = '#C5912B',
  '129' = '#B65C73',
  '128' = '#C2655D',
  '127' = '#C2655D',
  '126' = '#D56F80',
  '125' = '#55A354',
  '123' = '#924965',
  '122' = '#4178AE',
  '121' = '#678C69',
  '120' = '#55A354',
  '118' = '#4178AE',
  '117' = '#4178AE',
  '116' = '#F182BC',
  '114' = '#FF9D0C',
  '113' = '#FFD924',
  '112' = '#B65C73',
  '111' = '#678C69',
  '110' = '#B65C73',
  '109' = '#999999',
  '108' = '#69608A',
  '107' = '#69608A',
  '105' = '#4178AE',
  '103' = '#999999',
  '102' = '#999999',
  '101' = '#FFD924',
  '100' = '#999999',
  '99' = '#C5912B',
  '98' = '#55A354',
  '97' = '#C2655D',
  '94' = '#678C69',
  '92' = '#DAB92E',
  '91' = '#C2655D',
  '90' = '#924965',
  '89' = '#C58DAA',
  '88' = '#924965',
  '87' = '#D56F80',
  '86' = '#4178AE',
  '85' = '#999999',
  '84' = '#55A354',
  '82' = '#678C69',
  '81' = '#678C69',
  '80' = '#678C69',
  '79' = '#C58DAA',
  '78' = '#69608A',
  '77' = '#C58DAA',
  '76' = '#999999',
  '75' = '#C58DAA',
  '74' = '#4178AE',
  '73' = '#FF9D0C',
  '72' = '#F182BC',
  '71' = '#4178AE',
  '70' = '#C2655D',
  '69' = '#55A354',
  '68' = '#FF9D0C',
  '67' = '#4178AE',
  '66' = '#55A354',
  '65' = '#678C69',
  '64' = '#FF9D0C',
  '62' = '#C58DAA',
  '61' = '#FF9D0C',
  '60' = '#999999',
  '59' = '#999999',
  '58' = '#C58DAA',
  '57' = '#D56F80',
  '56' = '#C5912B',
  '55' = '#4178AE',
  '54' = '#C58DAA',
  '53' = '#FF9D0C',
  '52' = '#55A354',
  '51' = '#924965',
  '48' = '#C2655D',
  '47' = '#69608A',
  '46' = '#FF9D0C',
  '45' = '#C5912B',
  '44' = '#69608A',
  '43' = '#C2655D',
  '42' = '#C5912B',
  '41' = '#69608A',
  '40' = '#999999',
  '39' = '#55A354',
  '38' = '#C2655D',
  '37' = '#4178AE',
  '36' = '#FF9D0C',
  '35' = '#678C69',
  '33' = '#D56F80',
  '32' = '#C58DAA',
  '31' = '#DAB92E',
  '30' = '#678C69',
  '29' = '#999999',
  '27' = '#FF9D0C',
  '26' = '#4178AE',
  '25' = '#4178AE',
  '24' = '#C2655D',
  '23' = '#C2655D',
  '22' = '#C58DAA',
  '21' = '#999999',
  '20' = '#4178AE',
  '19' = '#999999',
  '18' = '#DAB92E',
  '16' = '#C58DAA',
  '15' = '#C5912B',
  '14' = '#924965',
  '13' = '#55A354',
  '12' = '#C5912B',
  '11' = '#55A354',
  '10' = '#999999',
  '9' = '#FF9D0C',
  '8' = '#69608A',
  '7' = '#C2655D',
  '6' = '#C58DAA',
  '5' = '#C2655D',
  '4' = '#D56F80',
  '3' = '#678C69',
  '2' = '#4178AE',
  '1' = '#C2655D'
)

scale_state_aggregate <-
  scale_color_manual(name='State (aggregate)',
                     values=c('promoter' = '#ff0000', 'enhancer' = '#faca00',
                       'insulator' = '#09befe', 'transcribed' = '#00b050',
                       'repressed' = '#7f7f7f', 'other' = 'black',
                       'poly-A+-RNA-seq' = '#005c1f', 'diff-expressed' = '#0060a0'))

enh_cluster_ordering <- c(77, 125, 226, 128, 96, 115, 147, 168, 88, 95, 165, 202,
                          131, 51, 211, 14, 41, 90, 123, 171, 17, 47, 200, 205, 44, 203, 108, 8, 78, 107,
                          219, 222, 86, 117, 2, 55, 118, 175, 122, 20, 37, 156, 223, 105, 160, 199, 25,
                          214, 26, 36, 138, 67, 71, 34, 152, 69, 120, 197, 135, 13, 39, 66, 98, 173, 207,
                          11, 63, 119, 52, 84, 191, 94, 153, 164, 3, 30, 65, 178, 213, 215, 81, 121, 189,
                          210, 35, 193, 198, 111, 186, 80, 82, 216, 129, 190, 206, 110, 146, 169, 181,
                          209, 220, 112, 184, 154, 192, 208, 68, 104, 124, 114, 140, 201, 27, 73, 196,
                          46, 64, 53, 61, 224, 225, 9, 159, 163, 172, 56, 74, 83, 101, 113, 31, 18, 92,
                          158, 12, 42, 177, 221, 130, 28, 134, 182, 99, 166, 15, 45, 48, 149, 38, 151,
                          180, 91, 167, 1, 5, 23, 24, 70, 161, 43, 97, 127, 170, 4, 145, 183, 57, 87,
                          144, 212, 218, 33, 126, 174, 179, 72, 116, 133, 141, 204, 7, 79, 54, 136, 142,
                          148, 150, 6, 22, 137, 50, 89, 132, 155, 62, 143, 157, 16, 194, 32, 58, 75, 85,
                          19, 102, 40, 76, 21, 59, 185, 195, 29, 187, 188, 100, 217, 10, 139, 176, 60,
                          109, 162, 49, 93, 103, 106)

eid_ordering <- c("E017", "E002", "E008", "E001", "E015", "E014", "E016",
                  "E003", "E024", "E020", "E019", "E018", "E021", "E022", "E007", "E009", "E010",
                  "E013", "E012", "E011", "E004", "E005", "E006", "E062", "E034", "E045", "E033",
                  "E044", "E043", "E039", "E041", "E042", "E040", "E037", "E048", "E038", "E047",
                  "E029", "E031", "E035", "E051", "E050", "E036", "E032", "E046", "E030", "E026",
                  "E049", "E025", "E023", "E052", "E055", "E056", "E059", "E061", "E057", "E058",
                  "E028", "E027", "E054", "E053", "E112", "E093", "E071", "E074", "E068", "E069",
                  "E072", "E067", "E073", "E070", "E082", "E081", "E063", "E100", "E108", "E107",
                  "E089", "E090", "E083", "E104", "E095", "E105", "E065", "E078", "E076", "E103",
                  "E111", "E092", "E085", "E084", "E109", "E106", "E075", "E101", "E102", "E110",
                  "E077", "E079", "E094", "E099", "E086", "E088", "E097", "E087", "E080", "E091",
                  "E066", "E098", "E096", "E113", "E114", "E115", "E116", "E117", "E118", "E119",
                  "E120", "E121", "E122", "E123", "E124", "E125", "E126", "E127")
